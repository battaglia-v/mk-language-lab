appId: com.mk.language.lab
tags:
  - mission
  - xp
  - integration
---
# Mission XP Integration Test
# Tests XP calculation, mission progress updates, and integration between practice sessions and mission tracking

- launchApp

# ============================================================
# SECTION 1: Initial Mission State
# ============================================================

# Verify we're on Home tab with mission displayed
- assertVisible:
    text: "Добредојде назад"
- assertVisible:
    text: "Nova"

# Wait for mission data to load
- waitForAnimationToEnd:
    timeout: 5000

# Verify initial XP/progress state
- assertVisible:
    text: "Goal"

# The mission hero should display:
# - Current XP earned today/this session
# - Daily XP goal
# - Progress bar or ring showing completion percentage

# ============================================================
# SECTION 2: Practice Session for XP Earning
# ============================================================

# Navigate to Practice to earn XP
- tapOn:
    text: "Practice"
- waitForAnimationToEnd

# Verify practice session loads
- assertVisible:
    text: "Quick Practice"

# Wait for session initialization
- waitForAnimationToEnd:
    timeout: 5000

# Verify XP goal is displayed in practice HUD
- assertVisible:
    text: "Goal"
- assertVisible:
    text: "Accuracy"

# Scroll to practice controls
- scroll

# ============================================================
# SECTION 3: Earn XP Through Practice
# ============================================================

# Skip multiple cards to simulate practice session
# Each skip or answer should affect XP

- tapOn:
    text: "Skip card"
- waitForAnimationToEnd:
    timeout: 2000

# Check if HUD updates after action
- assertVisible:
    text: "Goal"

# Continue practicing
- tapOn:
    text: "Skip card"
- waitForAnimationToEnd:
    timeout: 2000

- tapOn:
    text: "Skip card"
- waitForAnimationToEnd:
    timeout: 2000

# After multiple actions, XP should accumulate
# HUD should show updated XP values

# ============================================================
# SECTION 4: Verify Mission Progress Updates
# ============================================================

# Navigate back to Home to verify mission progress updated
- tapOn:
    text: "Home"
- waitForAnimationToEnd

# Mission hero should reflect XP earned from practice
- assertVisible:
    text: "Goal"

# The mission progress indicator should show:
# - Increased XP count
# - Updated progress bar/ring
# - Potentially new achievement badges or streak indicators

# Verify mission state persists
- assertVisible:
    text: "Continue"
- assertVisible:
    text: "Coach"

# ============================================================
# SECTION 5: Multiple Practice Sessions
# ============================================================

# Test that XP accumulates across multiple sessions
# Return to practice for another round

- tapOn:
    text: "Practice"
- waitForAnimationToEnd

# Verify practice restarts or continues
- assertVisible:
    text: "Quick Practice"
- assertVisible:
    text: "Goal"

# Scroll to controls
- scroll

# Practice more to earn additional XP
- tapOn:
    text: "Skip card"
- waitForAnimationToEnd:
    timeout: 2000

- tapOn:
    text: "Skip card"
- waitForAnimationToEnd:
    timeout: 2000

# ============================================================
# SECTION 6: Return to Mission - Cumulative XP
# ============================================================

# Navigate back to Home
- tapOn:
    text: "Home"
- waitForAnimationToEnd

# Mission should show cumulative XP from both sessions
- assertVisible:
    text: "Goal"

# The mission UI should update to reflect:
# - Total XP earned across all practice sessions
# - Progress toward daily/weekly goals
# - Achievement unlocks if thresholds met

# ============================================================
# SECTION 7: Mission Goal Completion
# ============================================================

# If enough XP has been earned, mission may show completion state
# Look for completion indicators or "goal reached" messaging

# Scroll through mission to see updated content
- scroll

# Smart Review section may change based on XP/progress
- assertVisible:
    text: "Smart review"

# Continue scrolling to see mission updates
- scroll

# ============================================================
# SECTION 8: XP Persistence & Navigation
# ============================================================

# Test XP persistence by navigating away and back
- tapOn:
    text: "Discover"
- waitForAnimationToEnd

- tapOn:
    text: "Profile"
- waitForAnimationToEnd

- tapOn:
    text: "Home"
- waitForAnimationToEnd

# Mission XP should persist across navigation
- assertVisible:
    text: "Goal"
- assertVisible:
    text: "Continue"

# ============================================================
# SECTION 9: Practice Mode Impact on XP
# ============================================================

# Test if different practice modes affect XP differently
- tapOn:
    text: "Practice"
- waitForAnimationToEnd

# Wait for practice to load
- waitForAnimationToEnd:
    timeout: 5000

# Try different practice modes
- assertVisible:
    text: "Typing"
- assertVisible:
    text: "Multiple choice"

# Switch to Multiple Choice mode
- tapOn:
    text: "Multiple choice"
- waitForAnimationToEnd

# Scroll to controls
- scroll

# Practice in Multiple Choice mode
- tapOn:
    text: "Skip card"
- waitForAnimationToEnd:
    timeout: 2000

# Switch to Typing mode
- scroll:
    direction: UP
- tapOn:
    text: "Typing"
- waitForAnimationToEnd

# Scroll and practice
- scroll
- tapOn:
    text: "Skip card"
- waitForAnimationToEnd:
    timeout: 2000

# ============================================================
# SECTION 10: Return to Mission - Mode XP Validation
# ============================================================

# Navigate back to mission
- tapOn:
    text: "Home"
- waitForAnimationToEnd

# Mission should reflect XP from different modes
- assertVisible:
    text: "Goal"

# Different modes may award different XP amounts:
# - Multiple Choice: lower XP (easier)
# - Typing: higher XP (harder)
# - Cloze: medium XP
# - Listening: varied XP

# ============================================================
# SECTION 11: Direction Impact on XP
# ============================================================

# Test if translation direction affects XP
- tapOn:
    text: "Practice"
- waitForAnimationToEnd

# Wait for practice load
- waitForAnimationToEnd:
    timeout: 5000

# Switch direction from EN → MK to MK → EN
- assertVisible:
    text: "EN → MK"
- tapOn:
    text: "MK → EN"
- waitForAnimationToEnd

# Practice in reverse direction
- scroll
- tapOn:
    text: "Skip card"
- waitForAnimationToEnd:
    timeout: 2000

# Navigate back to mission
- tapOn:
    text: "Home"
- waitForAnimationToEnd

# Mission should track XP regardless of direction
- assertVisible:
    text: "Goal"

# ============================================================
# SECTION 12: Practice Settings Impact on XP
# ============================================================

# Test if session settings (mode, helpers) affect XP
- tapOn:
    text: "Practice"
- waitForAnimationToEnd

# Wait for load
- waitForAnimationToEnd:
    timeout: 5000

# Open practice settings
- tapOn:
    text: "Session settings"
- waitForAnimationToEnd

# Verify settings modal
- assertVisible:
    text: "Session Settings"

# Change mode to Blitz (harder, more XP)
- assertVisible:
    text: "Blitz"
- tapOn:
    text: "Blitz"
- waitForAnimationToEnd

# Disable helpers to increase difficulty/XP
- assertVisible:
    text: "Smart hints"
- tapOn:
    text: "Smart hints"
- waitForAnimationToEnd

# Close settings
- tapOn:
    text: "Cancel"
- waitForAnimationToEnd

# Practice in Blitz mode
- scroll
- tapOn:
    text: "Skip card"
- waitForAnimationToEnd:
    timeout: 2000

# Navigate to mission
- tapOn:
    text: "Home"
- waitForAnimationToEnd

# Mission should reflect Blitz XP (potentially higher)
- assertVisible:
    text: "Goal"

# ============================================================
# SECTION 13: XP Display Consistency
# ============================================================

# Verify XP is displayed consistently across the app
- assertVisible:
    text: "Goal"

# Check mission hero
- assertVisible:
    text: "Continue"

# Scroll to check other mission sections
- scroll

# Smart Review may show XP opportunities
- assertVisible:
    text: "Smart review"

# ============================================================
# SECTION 14: Final XP Validation
# ============================================================

# Navigate back to top
- scroll:
    direction: UP

# Final check of mission XP state
- assertVisible:
    text: "Goal"
- assertVisible:
    text: "Nova"

# Verify XP integration is working by checking:
# - Mission displays XP
# - Practice earns XP
# - XP updates are reflected in mission
# - XP persists across navigation

# Navigate to practice one more time
- tapOn:
    text: "Practice"
- waitForAnimationToEnd

# Verify XP goal is consistent
- assertVisible:
    text: "Goal"

# Navigate back to mission
- tapOn:
    text: "Home"
- waitForAnimationToEnd

# Final mission state verification
- assertVisible:
    text: "Goal"
- assertVisible:
    text: "Continue"
- assertVisible:
    text: "Coach"
