appId: com.mk.language.lab
tags:
  - practice
  - session
  - xp
---
# Comprehensive Practice Session Flow
# Tests complete practice session including answer validation, XP earning, mode switching, and session completion

- launchApp

# ============================================================
# SECTION 1: Practice Session Initialization
# ============================================================

# Navigate to Practice tab
- tapOn:
    text: "Practice"

# Verify we're on the Practice screen
- assertVisible:
    text: "Quick Practice"
- assertVisible:
    text: "Swipe through prompts, keep your hearts, and reach the XP goal."

# Wait for practice session to load
- waitForAnimationToEnd:
    timeout: 5000

# ============================================================
# SECTION 2: Session HUD & Progress Tracking
# ============================================================

# Verify XP/Hearts HUD is displayed at the top
- assertVisible:
    text: "Goal"
- assertVisible:
    text: "Accuracy"

# The HUD should show:
# - Current XP earned in this session
# - XP goal for the session
# - Hearts remaining (accuracy meter)
# - Current card count / total cards

# ============================================================
# SECTION 3: Direction & Language Selection
# ============================================================

# Verify direction toggles are present
- assertVisible:
    text: "EN → MK"
- assertVisible:
    text: "MK → EN"

# Test direction toggle interaction
- tapOn:
    text: "MK → EN"
- waitForAnimationToEnd

# Verify direction changed and affects practice prompts
- assertVisible:
    text: "MK → EN"

# Switch back to EN → MK
- tapOn:
    text: "EN → MK"
- waitForAnimationToEnd

# ============================================================
# SECTION 4: Practice Mode Selection
# ============================================================

# Verify all practice modes are available
- assertVisible:
    text: "Typing"
- assertVisible:
    text: "Cloze"
- assertVisible:
    text: "Multiple choice"

# Listening mode may also be available
# but might require audio capabilities

# Test mode selection - Typing mode
- tapOn:
    text: "Typing"
- waitForAnimationToEnd:
    timeout: 2000

# Verify typing input interface appears
# This should show a text input field for answers

# Switch to Multiple Choice mode
- tapOn:
    text: "Multiple choice"
- waitForAnimationToEnd:
    timeout: 2000

# Verify multiple choice options appear
# Should show answer buttons/options

# Switch to Cloze (fill in the blank) mode
- tapOn:
    text: "Cloze"
- waitForAnimationToEnd:
    timeout: 2000

# ============================================================
# SECTION 5: Category/Topic Filtering
# ============================================================

# Verify category filter is present
- assertVisible:
    text: "All topics"

# Test category selection
# Tap on category filter to see available topics
- tapOn:
    text: "All topics"
- waitForAnimationToEnd

# Category modal/dropdown should appear
# showing available vocabulary categories:
# - Family, Numbers, Colors, Food, etc.

# For now, we'll close by tapping the same button again
# or selecting a category if available
- waitForAnimationToEnd

# ============================================================
# SECTION 6: Card Stack & Practice Interaction
# ============================================================

# Scroll down to see the practice card stack
- scroll

# Verify session controls are available
- assertVisible:
    text: "Skip card"
- assertVisible:
    text: "Reset session"

# The practice card stack should display:
# - Current vocabulary word/phrase
# - Translation prompt
# - Answer input area
# - Visual feedback for correct/incorrect answers

# Test Skip Card functionality
# This should move to the next card without answering
- tapOn:
    text: "Skip card"
- waitForAnimationToEnd:
    timeout: 2000

# After skipping, HUD should update
# Hearts may decrease or card count should increase
- assertVisible:
    text: "Goal"

# ============================================================
# SECTION 7: Answer Validation & Feedback
# ============================================================

# In a real practice session, we would:
# 1. Read the prompt
# 2. Enter an answer
# 3. Submit the answer
# 4. Verify correct/incorrect feedback
# 5. Check XP gain or heart loss

# Since Maestro can't easily interact with dynamic text content,
# we validate the structure is working

# Skip another card to test card progression
- tapOn:
    text: "Skip card"
- waitForAnimationToEnd:
    timeout: 2000

# ============================================================
# SECTION 8: Session Settings Modal
# ============================================================

# Scroll back up to access session settings
- scroll:
    direction: UP

# Open Practice Settings modal
- tapOn:
    text: "Session settings"
- waitForAnimationToEnd

# Verify modal opened with settings options
- assertVisible:
    text: "Session Settings"
- assertVisible:
    text: "Mode"
- assertVisible:
    text: "Helpers"

# ============================================================
# SECTION 9: Practice Mode Settings
# ============================================================

# Verify mode options are displayed
- assertVisible:
    text: "Casual"
- assertVisible:
    text: "Focus"
- assertVisible:
    text: "Blitz"

# Test mode selection
# Casual: relaxed practice with hints
# Focus: standard practice
# Blitz: timed, fast-paced practice

- tapOn:
    text: "Focus"
- waitForAnimationToEnd

# ============================================================
# SECTION 10: Helper Settings
# ============================================================

# Verify helper toggles are available
- assertVisible:
    text: "Audio prompts"
- assertVisible:
    text: "Smart hints"

# These toggles should enable/disable:
# - Audio prompts: Text-to-speech for vocabulary
# - Smart hints: Contextual hints when struggling

# Test toggle interaction
- tapOn:
    text: "Audio prompts"
- waitForAnimationToEnd

# Toggle it back
- tapOn:
    text: "Audio prompts"
- waitForAnimationToEnd

# ============================================================
# SECTION 11: Apply Settings & Return to Practice
# ============================================================

# Close the modal and return to practice
- tapOn:
    text: "Cancel"
- waitForAnimationToEnd

# Verify we're back on practice screen
- assertVisible:
    text: "Quick Practice"

# Verify session controls are still available
- scroll
- assertVisible:
    text: "Skip card"

# ============================================================
# SECTION 12: Session Reset
# ============================================================

# Test Reset Session functionality
# This should restart the practice session from the beginning

- tapOn:
    text: "Reset session"
- waitForAnimationToEnd:
    timeout: 3000

# After reset, session should restart
# HUD values should reset to initial state
- assertVisible:
    text: "Goal"

# ============================================================
# SECTION 13: Session Completion Flow
# ============================================================

# In a complete session, after answering enough cards correctly:
# 1. XP goal is reached
# 2. Completion modal/screen appears
# 3. Session summary is shown (XP earned, accuracy, time)
# 4. Options to continue or finish

# Since we can't complete a full session in automated tests,
# we verify the session framework is functional

# Scroll back to top
- scroll:
    direction: UP

# Verify practice session is still active
- assertVisible:
    text: "Quick Practice"
- assertVisible:
    text: "Goal"

# ============================================================
# SECTION 14: Practice Persistence & Navigation
# ============================================================

# Test navigation away from practice
- tapOn:
    text: "Home"
- waitForAnimationToEnd

# Verify we navigated to Home
- assertVisible:
    text: "Continue"

# Navigate back to Practice
- tapOn:
    text: "Practice"
- waitForAnimationToEnd

# Practice session should persist or restart cleanly
- assertVisible:
    text: "Quick Practice"

# ============================================================
# SECTION 15: XP Integration with Mission
# ============================================================

# XP earned from practice should contribute to mission progress
# Navigate to Home to verify mission progress reflects practice

- tapOn:
    text: "Home"
- waitForAnimationToEnd

# Mission hero should show updated XP/progress
- assertVisible:
    text: "Goal"
- assertVisible:
    text: "Continue"

# ============================================================
# SECTION 16: Final Validation
# ============================================================

# Return to Practice one more time
- tapOn:
    text: "Practice"

# Verify all key practice elements are accessible
- assertVisible:
    text: "Quick Practice"
- assertVisible:
    text: "EN → MK"
- assertVisible:
    text: "Typing"
- assertVisible:
    text: "Goal"

# Scroll to session controls
- scroll

# Final validation of session controls
- assertVisible:
    text: "Skip card"
- assertVisible:
    text: "Reset session"
