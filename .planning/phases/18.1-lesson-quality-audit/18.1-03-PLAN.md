---
phase: 18.1-lesson-quality-audit
plan: 03
type: execute
---

<objective>
Add new interactive exercise types to improve exercise variety and engagement.

Purpose: Address audit finding that exercise variety scored 6.5/10 with only 3 types (multiple_choice, fill_blank, translation). Add 2-3 new exercise types for more engaging practice.
Output: New exercise components and updated ExerciseSection to support additional types.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
./summary.md
~/.claude/get-shit-done/references/checkpoints.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@components/learn/ExerciseSection.tsx
@prisma/schema.prisma

**Current exercise types:**
- multiple_choice: Select correct answer from options
- fill_blank: Type missing word
- translation: Translate sentence/phrase

**Proposed new types:**
1. **matching**: Match Macedonian words to English translations (drag-drop or tap)
2. **word_order**: Arrange shuffled words into correct sentence order
3. **listening** (future): Listen to audio and select/type answer

**Database schema:**
Exercise model has `type` field (string). New types just need renderer support.

**UX patterns established:**
- Hint system (Show Hint button with first letter)
- Progress tracking (X of Y completed)
- Retry functionality
- Correct/incorrect visual feedback
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add matching exercise type</name>
  <files>components/learn/ExerciseSection.tsx</files>
  <action>
    Add `renderMatching(exercise)` function to ExerciseSection.

    Matching exercise format:
    - `options`: Pipe-separated Macedonian words (e.g., "здраво|благодарам|извини")
    - `correctAnswer`: Pipe-separated English matches in same order (e.g., "hello|thank you|excuse me")

    Implementation:
    1. Display Macedonian words on left, shuffled English on right
    2. User taps/clicks to select pairs
    3. Show connection line or highlight when matched
    4. Check button validates all pairs
    5. Show correct matches on check

    Use existing UI patterns (Button variant="choice", CheckCircle/XCircle icons).
    Mobile-friendly: tap-to-select rather than drag-drop.
  </action>
  <verify>
    - `npm run type-check` passes
    - renderMatching function exists
    - Exercise type 'matching' renders correctly
  </verify>
  <done>Matching exercise type functional with tap-to-select UX</done>
</task>

<task type="auto">
  <name>Task 2: Add word order exercise type</name>
  <files>components/learn/ExerciseSection.tsx</files>
  <action>
    Add `renderWordOrder(exercise)` function to ExerciseSection.

    Word order exercise format:
    - `question`: The sentence meaning (e.g., "How are you?")
    - `options`: Shuffled words pipe-separated (e.g., "си|Како|ти|?")
    - `correctAnswer`: Correct order (e.g., "Како си ти?")

    Implementation:
    1. Display shuffled words as tappable chips
    2. Tapping adds word to answer area
    3. Tapping in answer area removes word
    4. Clear button resets
    5. Check validates against correctAnswer (normalize whitespace)

    Styling: Use rounded chips with bg-muted, selected chips move to answer area.
  </action>
  <verify>
    - `npm run type-check` passes
    - renderWordOrder function exists
    - Exercise type 'word_order' renders correctly
  </verify>
  <done>Word order exercise type functional with tap-to-arrange UX</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Two new exercise types: matching and word_order</what-built>
  <how-to-verify>
    1. Start dev server: `npm run dev`
    2. Navigate to a lesson with exercises
    3. If no matching/word_order exercises exist yet, temporarily modify seed data or add test exercises
    4. Test matching: Select pairs, verify validation, check mobile tap behavior
    5. Test word_order: Arrange words, verify validation, check clear button
    6. Verify both types follow existing visual patterns (progress bar, hint system colors)
  </how-to-verify>
  <resume-signal>Type "approved" or describe issues to fix</resume-signal>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] Matching exercise type implemented
- [ ] Word order exercise type implemented
- [ ] Both types use consistent UI patterns
- [ ] `npm run type-check` passes
- [ ] `npm run lint` passes
- [ ] Visual verification approved
</verification>

<success_criteria>
- ExerciseSection supports 5 exercise types (multiple_choice, fill_blank, translation, matching, word_order)
- New types use existing hint/progress/retry patterns
- Mobile-friendly tap interactions
- Type check and lint pass
</success_criteria>

<output>
After completion, create `.planning/phases/18.1-lesson-quality-audit/18.1-03-SUMMARY.md`
</output>
