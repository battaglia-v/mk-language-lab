---
phase: 68-practice-modes
plan: 68.1
type: execute
priority: urgent
---

<objective>
Fix React version conflicts in mobile app to unblock all mobile testing and development.

Purpose: Resolve "Invalid hook call" errors caused by multiple React versions (19.1.0 and 19.2.0) that prevent mobile app from running.
Output: Mobile app runs successfully in iOS Simulator/Android with all hooks working correctly.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
~/.claude/get-shit-done/templates/summary-frontmatter.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

# Current state:
- Mobile app fails to run with "Invalid hook call" error
- Two React versions installed: react@19.1.0 (via expo-auth-session@6.0.3) and react@19.2.0 (via other packages)
- Error appears in apps/mobile/app/_layout.tsx when calling useEffect
- Blocks all mobile app testing including Grammar Practice (phase 68-01)

# Files to review:
@apps/mobile/package.json
@package.json

**Root cause**: expo-auth-session@6.0.3 depends on expo-linking@7.0.5 which requires react@19.1.0, while everything else uses react@19.2.0.

**Fix strategy**: Update expo-auth-session and expo-web-browser to latest versions compatible with current expo SDK, or replace auth packages.
</context>

<tasks>

<task type="auto">
  <name>Task 1: Investigate dependency tree and identify conflicts</name>
  <files>apps/mobile/package.json</files>
  <action>
Run dependency analysis to identify all packages causing React version conflicts:

```bash
npm ls react
npm ls react-native
```

Document findings:
- Which packages require react@19.1.0
- Which packages require react@19.2.0
- Check if expo-auth-session and expo-web-browser have updates available
- Verify current expo SDK version (should be ~52)

Expected findings:
- expo-auth-session@6.0.3 → needs update to ~7.0.10
- expo-web-browser@14.0.2 → needs update to ~15.0.10
- react-native-svg@15.15.1 → needs update to 15.12.1 (minor)
  </action>
  <verify>npm ls react shows only one React version across all packages</verify>
  <done>Documented all conflicting packages and available updates</done>
</task>

<task type="auto">
  <name>Task 2: Update conflicting Expo packages</name>
  <files>apps/mobile/package.json</files>
  <action>
Update packages to resolve React version conflicts:

1. Update expo-auth-session to latest compatible version:
```bash
cd apps/mobile
npx expo install expo-auth-session@latest
```

2. Update expo-web-browser to latest compatible version:
```bash
npx expo install expo-web-browser@latest
```

3. Verify updates resolved React version conflict:
```bash
npm ls react | grep -E "react@"
```

4. If conflicts persist, try clean reinstall:
```bash
rm -rf node_modules package-lock.json
npm install
```

5. Verify no duplicate React versions remain.
  </action>
  <verify>npm ls react shows single React version; npm run type-check passes</verify>
  <done>All packages use same React version (19.2.0)</done>
</task>

<task type="auto">
  <name>Task 3: Test mobile app launches successfully</name>
  <files>apps/mobile/app/_layout.tsx</files>
  <action>
Verify mobile app runs without React hook errors:

1. Start dev server:
```bash
cd apps/mobile
npx expo start --clear --ios
```

2. Verify app launches in iOS Simulator without errors:
   - No "Invalid hook call" errors
   - App loads to home screen
   - Navigation works
   - useEffect, useState, and other hooks work in _layout.tsx

3. Test Grammar Practice feature (from phase 68-01):
   - Navigate to Practice tab
   - Tap Grammar Practice card
   - Verify lesson list loads
   - Open a lesson
   - Complete an exercise
   - Verify progress saves

4. Document test results in summary.
  </action>
  <verify>Mobile app runs successfully; Grammar Practice feature works end-to-end</verify>
  <done>Mobile app launches without errors; all hooks work correctly</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npm ls react` shows only one React version (19.2.0)
- [ ] `npm run type-check` passes (root)
- [ ] `cd apps/mobile && npx tsc --noEmit` passes
- [ ] `npx expo start --ios` launches app successfully
- [ ] No "Invalid hook call" errors in console
- [ ] Can navigate between tabs
- [ ] Grammar Practice feature works (navigate, load list, complete exercise)
- [ ] Progress saves to AsyncStorage
</verification>

<success_criteria>
- Single React version across all mobile dependencies
- Mobile app runs successfully in iOS Simulator
- All React hooks work without errors
- Grammar Practice feature (68-01) is testable
- No regression in existing mobile features
</success_criteria>

<output>
After completion, create `.planning/phases/68-practice-modes/68.1-SUMMARY.md` following summary-frontmatter.md template.
</output>
