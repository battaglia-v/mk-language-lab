---
phase: 43-vocabulary-grammar-audit
plan: 01
type: execute
---

<objective>
Audit and curate vocabulary to 30-50 focused, theme-relevant words per lesson.

Purpose: Current vocabulary extraction produced 25,560 items with instructional words, proper nouns, and duplicates. Lessons need focused vocabulary sets aligned with lesson themes and CEFR levels.
Output: Updated vocabulary JSON files with curated content, reseeded database, audit report showing before/after metrics.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
./summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/42-lesson-flow-simplification/42-01-SUMMARY.md
@.planning/phases/43-vocabulary-grammar-audit/43-CONTEXT.md

# Vocabulary Data Sources
@data/curriculum/structured/a1-teskoto.json
@data/curriculum/structured/a2-lozje.json
@data/curriculum/structured/b1-zlatovrv.json

# Existing Correction Scripts
@scripts/curriculum/vocabulary-corrections.ts

# UI Component (shows current filtering logic)
@components/learn/VocabularySection.tsx

**Current State:**
- A1: 5,186 vocabulary items (avg 216/lesson) - ranging 74-343 per lesson
- A2: 8,372 vocabulary items (avg 1,047/lesson) - massively over-extracted
- B1: 12,002 vocabulary items (avg 1,500/lesson) - massively over-extracted
- UI filters to MAX 20 at runtime, hiding the bloat but not fixing source

**Key Issues:**
1. Instructional words included (Вежба, Состави, Прочитај, Напиши, etc.)
2. Proper nouns from exercises (Ѓорѓи, Влатко, names not relevant to themes)
3. Words duplicated across many lessons (should appear in first introduction only)
4. Theme misalignment (words from textbook exercises, not vocabulary lists)

**Target State:**
- Each lesson has 30-50 focused vocabulary items
- Words are theme-relevant (Lesson 8 "Food & Drink" → food words)
- Instructional/meta words removed from source data
- Proper nouns appropriately flagged or removed
- First-appearance rule: words appear only in their first lesson
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create vocabulary audit report script</name>
  <files>scripts/curriculum/vocabulary-audit-report.ts</files>
  <action>
Create a script that analyzes all vocabulary files and produces a detailed audit report:

1. **Per-lesson statistics:**
   - Total word count
   - Instructional word count (matching known patterns)
   - Proper noun count (capitalized + weak translation)
   - Words with quality translations vs poor translations

2. **Duplication analysis:**
   - Words appearing in multiple lessons
   - First lesson of introduction for each word
   - Candidates for removal from subsequent lessons

3. **Theme alignment sampling:**
   - Extract lesson title/theme
   - Sample 10 random words
   - Heuristic: does word match lesson theme?

4. **Part-of-speech distribution:**
   - Nouns, verbs, adjectives per lesson
   - Flag lessons with unusual distribution

**Instructional words to detect:**
- Verbs: прочитај, напиши, одговори, слушај, говори, погледни, пополни, повтори, состави, заокружи, подвлечи, избери, преведи
- Meta: вежба, лекција, тема, пример, примери, текст, слика, слики, задача, прашање
- From VocabularySection.tsx EXCLUDED_WORDS set as baseline

Output:
- Console summary with key metrics
- JSON report to `data/curriculum/vocabulary-audit.json` with full details

Run with: `npx tsx scripts/curriculum/vocabulary-audit-report.ts`
  </action>
  <verify>Script runs without errors, vocabulary-audit.json created with per-lesson stats</verify>
  <done>Audit report shows word counts, duplication metrics, and instructional word identification per lesson</done>
</task>

<task type="auto">
  <name>Task 2: Implement vocabulary curation script</name>
  <files>scripts/curriculum/curate-vocabulary.ts</files>
  <action>
Create a comprehensive curation script that processes all three curriculum files:

1. **Remove instructional/meta words:**
   - Expand known instructional word list from Task 1 findings
   - Case-insensitive matching
   - Remove entire vocabulary entry

2. **Deduplicate across lessons:**
   - Track first-seen lesson for each word (case-insensitive)
   - Keep word only in first lesson where it appears
   - Log removals with reason

3. **Remove weak proper nouns:**
   - Detect: Cyrillic capital letter + translation is same/similar to original
   - Keep: Country/city names in geography lessons
   - Keep: Names with real translations (мајка = mother)
   - Remove: Random exercise names (Влатко, Ема, Андреј)

4. **Cap vocabulary per lesson:**
   - Target: 30-50 words per lesson
   - Priority order:
     a. Words marked `isCore: true`
     b. Words with quality translations (not transliteration)
     c. Words with example sentences
   - If still >50, keep first 50 by original order

5. **Add grammar context where missing:**
   - Nouns: Add gender if detectable from ending/translation
   - Verbs: Note aspect if part of obvious pair
   - This integrates vocabulary with grammar per CONTEXT.md vision

**Output files:**
- `data/curriculum/structured/a1-teskoto-curated.json`
- `data/curriculum/structured/a2-lozje-curated.json`
- `data/curriculum/structured/b1-zlatovrv-curated.json`

Produce diff summary showing:
- Total removed per level
- Categories of removal (instructional, duplicate, weak noun)
- Per-lesson before/after counts

Run with: `npx tsx scripts/curriculum/curate-vocabulary.ts`
  </action>
  <verify>Curated JSON files exist, `jq '[.chapters[].vocabularyItems | length]' data/curriculum/structured/a1-teskoto-curated.json` shows counts in 30-50 range</verify>
  <done>Curated files created with 30-50 words per lesson average, instructional words removed, duplicates eliminated</done>
</task>

<task type="auto">
  <name>Task 3: Apply curation and reseed database</name>
  <files>data/curriculum/structured/a1-teskoto.json, data/curriculum/structured/a2-lozje.json, data/curriculum/structured/b1-zlatovrv.json</files>
  <action>
1. **Review curated output:**
   - Spot check 3 lessons per level
   - Verify theme alignment improved
   - Confirm no critical vocabulary lost

2. **Replace original files:**
   ```bash
   cp data/curriculum/structured/a1-teskoto-curated.json data/curriculum/structured/a1-teskoto.json
   cp data/curriculum/structured/a2-lozje-curated.json data/curriculum/structured/a2-lozje.json
   cp data/curriculum/structured/b1-zlatovrv-curated.json data/curriculum/structured/b1-zlatovrv.json
   ```

3. **Run vocabulary corrections (apply manual fixes):**
   ```bash
   npx tsx scripts/curriculum/vocabulary-corrections.ts
   ```

4. **Reseed database:**
   ```bash
   npx prisma db seed
   ```

5. **Validate:**
   ```bash
   npx tsx scripts/curriculum/validate-content.ts
   ```

**Target counts:**
- A1: ~800-1,200 total (down from 5,186)
- A2: ~400-600 total (down from 8,372)
- B1: ~400-600 total (down from 12,002)
  </action>
  <verify>
- `npx prisma db seed` completes without errors
- `npx tsx scripts/curriculum/validate-content.ts` passes
- Dev server shows curated vocabulary per lesson
  </verify>
  <done>Original JSON files replaced, database reseeded, validation passes, dev shows improved vocabulary</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npm run type-check` passes
- [ ] `npm run lint` passes
- [ ] Audit report exists at `data/curriculum/vocabulary-audit.json`
- [ ] Total vocabulary reduced to target ranges per level
- [ ] Lesson 8 "Food & Drink" (A1) shows primarily food-related words
- [ ] No instructional words (вежба, состави, прочитај) in vocabulary sections
- [ ] Database seeding completes without errors
</verification>

<success_criteria>

- All tasks completed
- Vocabulary reduced to 30-50 focused words per lesson
- Instructional/meta words removed from source data
- Cross-lesson duplication eliminated (first-appearance rule)
- Database reseeded with curated vocabulary
- Validation script passes
</success_criteria>

<output>
After completion, create `.planning/phases/43-vocabulary-grammar-audit/43-01-SUMMARY.md`:

# Phase 43 Plan 01: Vocabulary Audit & Curation Summary

**[One-liner: e.g., "Reduced vocabulary from 25,560 to 2,400 items with theme-aligned curation"]**

## Accomplishments

- [Audit findings summary]
- [Curation results - before/after counts per level]
- [Database reseed confirmation]

## Files Created/Modified

- `scripts/curriculum/vocabulary-audit-report.ts` - Audit script
- `scripts/curriculum/curate-vocabulary.ts` - Curation script
- `data/curriculum/structured/*.json` - Updated vocabulary
- `data/curriculum/vocabulary-audit.json` - Audit report

## Decisions Made

[Any decisions about word inclusion/exclusion criteria]

## Issues Encountered

[Problems and resolutions, or "None"]

## Next Phase Readiness

Ready for 43-02: Grammar Audit & Cleanup
</output>
