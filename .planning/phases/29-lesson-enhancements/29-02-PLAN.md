---
phase: 29-lesson-enhancements
plan: 02
type: execute
---

<objective>
Add mobile section stepper and lesson quick actions for better navigation and engagement.

Purpose: Improve mobile UX with visual progress dots and provide quick access to practice from within lesson sections. Currently mobile users only see "Step X of Y" text - visual stepper dots make progress more intuitive. Quick actions reduce friction for learners who want to practice immediately.
Output: Visual section stepper on mobile, quick practice buttons in vocabulary/grammar sections.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/29-lesson-enhancements/29-01-SUMMARY.md

# Key files for this phase:
@components/learn/LessonPageContentV2.tsx
@components/ui/progress.tsx

**Prior context:**
- LessonPageContentV2 already has: progress bar (line 887), section tabs on desktop (lines 898-929), floating continue button on mobile (lines 944-981)
- Desktop shows clickable section tabs with checkmarks for completed sections
- Mobile only shows "Step X of Y" text and progress bar - no visual stepper
- Phase 16-02 planned section progress dots but was never executed
- Quick actions pattern exists in dashboard (QuickActionsGrid) but not in lessons

**Constraining decisions:**
- [Phase 29-01]: Session-only sort preference - established pattern of minimal state persistence
- [Project]: "The app always resumes me in the right place and makes my next step obvious"
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add mobile section stepper dots</name>
  <files>components/learn/LessonPageContentV2.tsx</files>
  <action>
Add a visual section stepper below the progress bar for mobile users (hidden on desktop where tabs already show):

1. Create a `SectionStepper` component inside LessonPageContentV2 (or inline JSX):
```tsx
{/* Section stepper (mobile only - desktop has tabs) */}
<div className="flex items-center justify-center gap-2 mt-3 lg:hidden">
  {sections.map((section, index) => {
    const isCompleted = completedSections.has(section.id);
    const isCurrent = index === currentSectionIndex;
    const isPast = index < currentSectionIndex;

    return (
      <button
        key={section.id}
        onClick={() => {
          if (index <= currentSectionIndex || isCompleted) {
            setCurrentSectionIndex(index);
          }
        }}
        disabled={index > currentSectionIndex && !isCompleted}
        className={cn(
          'flex items-center justify-center rounded-full transition-all duration-200',
          // Size: current is larger
          isCurrent ? 'h-8 w-8' : 'h-6 w-6',
          // Colors
          isCompleted && 'bg-green-500 text-white',
          isCurrent && !isCompleted && 'bg-primary text-primary-foreground ring-2 ring-primary/30',
          isPast && !isCompleted && 'bg-muted text-muted-foreground',
          !isCurrent && !isCompleted && !isPast && 'bg-muted/50 text-muted-foreground/50',
          // Interactive
          (index <= currentSectionIndex || isCompleted) && 'hover:scale-110 cursor-pointer',
          index > currentSectionIndex && !isCompleted && 'cursor-not-allowed'
        )}
        aria-label={`${section.title} - ${isCompleted ? 'completed' : isCurrent ? 'current' : 'upcoming'}`}
      >
        {isCompleted ? (
          <CheckCircle className="h-4 w-4" />
        ) : (
          <span className="text-xs font-medium">{index + 1}</span>
        )}
      </button>
    );
  })}
</div>
```

2. Place this stepper in the header area, after the progress bar and before the desktop tabs:
   - Location: Around line 895, after the progress bar div closes
   - Visibility: `lg:hidden` to only show on mobile (desktop has full tabs)

3. Add connecting lines between dots for visual flow (optional but nice):
```tsx
{/* Connector line */}
{index < sections.length - 1 && (
  <div className={cn(
    'h-0.5 w-4 rounded-full transition-colors',
    isCompleted || isPast ? 'bg-green-500/50' : 'bg-muted'
  )} />
)}
```

4. Ensure the dots are tappable (min 44px touch target) - the button wrapper handles this.

**What to avoid:** Don't duplicate the desktop tabs logic - keep them separate. The stepper is mobile-only enhancement.
  </action>
  <verify>
1. npm run dev
2. Open lesson in mobile viewport (375px width)
3. Verify stepper dots appear below progress bar
4. Verify current section has larger, highlighted dot
5. Verify completed sections show checkmark
6. Verify tapping a past section navigates to it
7. Verify future sections are not clickable
8. npm run type-check - no errors
  </verify>
  <done>
- Mobile section stepper shows numbered dots for each section
- Current section is visually highlighted (larger, primary color)
- Completed sections show checkmark icon
- Past sections are tappable to navigate back
- Future sections are visually muted and not clickable
- Stepper hidden on desktop (tabs already serve this purpose)
  </done>
</task>

<task type="auto">
  <name>Task 2: Add quick practice action in vocabulary section</name>
  <files>components/learn/LessonPageContentV2.tsx, messages/en.json, messages/mk.json</files>
  <action>
Add a prominent "Practice Now" button at the end of the vocabulary section to encourage immediate practice:

1. In the vocabulary section rendering (around line 715, after the "hasMore" card), add a quick action card:
```tsx
{/* Quick practice action */}
<Card className="p-4 bg-gradient-to-r from-primary/10 to-primary/5 border-primary/20">
  <div className="flex items-center justify-between gap-4">
    <div className="flex items-center gap-3">
      <div className="h-10 w-10 rounded-full bg-primary/20 flex items-center justify-center">
        <Target className="h-5 w-5 text-primary" />
      </div>
      <div>
        <p className="font-medium">{t('vocabulary.readyToPractice')}</p>
        <p className="text-sm text-muted-foreground">
          {t('vocabulary.practiceDescription', { count: groupedVocabulary.totalCount })}
        </p>
      </div>
    </div>
    <Button
      onClick={() => router.push(`/${locale}/practice/session?deck=lesson-${lesson.id}&mode=flashcard`)}
      className="shrink-0"
    >
      <Dumbbell className="h-4 w-4 mr-2" />
      {t('vocabulary.practiceNow')}
    </Button>
  </div>
</Card>
```

2. Add i18n keys to messages/en.json under "vocabulary" section:
```json
"readyToPractice": "Ready to practice?",
"practiceDescription": "Test yourself on these {count} vocabulary words",
"practiceNow": "Practice Now"
```

3. Add corresponding Macedonian translations to messages/mk.json:
```json
"readyToPractice": "Спремни за вежбање?",
"practiceDescription": "Тестирајте се на овие {count} зборови",
"practiceNow": "Вежбај"
```

4. Position this card BEFORE the "Show more" indicator if it exists, so the practice CTA is always visible.

**What to avoid:** Don't add too many CTAs - one per section max. The practice action should feel like natural next step, not pushy.
  </action>
  <verify>
1. Navigate to lesson with vocabulary
2. Scroll to end of vocabulary section
3. Verify "Ready to practice?" card appears
4. Verify button links to practice session with correct lesson deck
5. Verify card appears in both English and Macedonian locales
6. npm run lint - no errors
  </verify>
  <done>
- Vocabulary section ends with "Ready to practice?" CTA card
- Button launches practice session for current lesson's vocabulary
- i18n strings added for both locales
- Card has subtle gradient styling consistent with app design
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Mobile section stepper and vocabulary quick practice action</what-built>
  <how-to-verify>
    1. Run: `npm run dev`
    2. Open lesson in mobile viewport (use browser DevTools, 375px width)
    3. **Section Stepper:**
       - Verify dots appear below the progress bar
       - Current section should be highlighted (larger, primary color)
       - Complete a section by clicking Continue
       - Verify completed section shows checkmark
       - Tap a past section dot - should navigate back
       - Verify future sections are not clickable
    4. Open lesson in desktop viewport (>1024px):
       - Verify stepper dots are hidden (tabs visible instead)
    5. **Vocabulary Quick Action:**
       - Navigate to vocabulary section
       - Scroll to bottom
       - Verify "Ready to practice?" card appears
       - Click "Practice Now" button
       - Verify redirects to practice session with lesson vocabulary
    6. Switch to Macedonian locale:
       - Verify stepper still works
       - Verify practice card shows Macedonian text
  </how-to-verify>
  <resume-signal>Type "approved" to continue, or describe issues to fix</resume-signal>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npm run build` succeeds without errors
- [ ] `npm run lint` passes
- [ ] `npm run type-check` passes
- [ ] Mobile section stepper visible and functional
- [ ] Desktop tabs still work (no regression)
- [ ] Vocabulary quick practice action visible and links correctly
- [ ] i18n strings present in both en.json and mk.json
</verification>

<success_criteria>

- Mobile section stepper shows visual progress dots
- Completed sections show checkmarks, current section highlighted
- Past sections are tappable for navigation
- Vocabulary section has "Practice Now" CTA
- Quick practice links to correct practice session
- i18n complete for both locales
- All verification checks pass
</success_criteria>

<output>
After completion, create `.planning/phases/29-lesson-enhancements/29-02-SUMMARY.md`:

# Phase 29-02: Section Stepper & Quick Actions Summary

**[Substantive one-liner about what shipped]**

## Accomplishments

- [Key outcome 1]
- [Key outcome 2]

## Files Created/Modified

- `path/to/file.ts` - Description

## Decisions Made

[Key decisions and rationale, or "None"]

## Issues Encountered

[Problems and resolutions, or "None"]

## Next Step

[Ready for Phase 30 or phase complete]
</output>
