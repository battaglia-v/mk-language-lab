---
phase: 10-a1-vocabulary-extraction
plan: 01
type: execute
---

<objective>
Improve A1 vocabulary extraction quality by filtering out function words and noise.

Purpose: Current extraction produces 7,513 items but most are common function words (и, да, со) not useful for learning. Need quality over quantity.
Output: A1 with 300-500 high-quality vocabulary items (20+ per lesson, meaningful words only).
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
./summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/09-extraction-pipeline-fix/09-01-SUMMARY.md

# Key files
@scripts/curriculum/vocabulary-patterns.ts
@scripts/curriculum/parse-a1-structure.ts
@data/curriculum/structured/a1-teskoto.json

**Tech stack available:** vocabulary-patterns.ts utilities, parse-a1-structure.ts
**Established patterns:** Macedonian-only vocabulary extraction, word list extraction, singular/plural detection

**Current state:**
- A1 has 7,513 vocabulary items (too many, low quality)
- Sample items: "и", "ти", "Во", "да", "со" - these are function words, not vocabulary
- Target: 300-500 quality items (20+ per lesson minimum)

**Root cause from Phase 9:**
- Stop word list only has 11 words: и, а, во, на, со, од, за, до, ги, се, ја
- extractThematicVocabulary is too aggressive (any 5+ word sequence)
- No minimum word length enforcement (allows 2-char words)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create comprehensive Macedonian stop word list</name>
  <files>scripts/curriculum/vocabulary-patterns.ts</files>
  <action>
Add a comprehensive MACEDONIAN_STOP_WORDS constant at the top of vocabulary-patterns.ts with common function words that should be excluded from vocabulary extraction:

1. Personal pronouns: јас, ти, тој, таа, тоа, ние, вие, тие, ми, те, го, ја, ги, нас, вас, нив
2. Possessive pronouns: мој, моја, мое, твој, твоја, твое, негов, нејзин, наш, ваш, нивни
3. Demonstratives: ова, тоа, она, овој, оваа, овие, тој, таа, тие, оној, онаа
4. Prepositions: во, на, со, од, за, до, по, под, над, пред, зад, кај, меѓу, покрај
5. Conjunctions: и, а, но, или, да, ако, кога, бидејќи, затоа, додека, дека, што, кој
6. Question words: што, кој, која, кое, кои, каде, кога, како, колку, зошто, дали
7. Particles/adverbs: не, многу, веќе, уште, само, сега, тогаш, овде, таму, тука
8. Auxiliary verbs: сум, си, е, сме, сте, се, беше, бев, бевме, ќе, би
9. Numbers: еден, два, три, четири, пет, шест, седум, осум, девет, десет
10. Common short words that appear frequently: тоа, ова, при, без, низ, ни, ти

Export the constant for reuse. Should have ~100-150 stop words total.
  </action>
  <verify>grep -c "MACEDONIAN_STOP_WORDS" scripts/curriculum/vocabulary-patterns.ts shows the constant exists</verify>
  <done>MACEDONIAN_STOP_WORDS constant exported with 100+ function words</done>
</task>

<task type="auto">
  <name>Task 2: Update vocabulary extraction to use stop words and stricter filtering</name>
  <files>scripts/curriculum/vocabulary-patterns.ts</files>
  <action>
Update all extraction functions to use the new stop word list:

1. In extractWordLists():
   - Replace inline filter array with MACEDONIAN_STOP_WORDS
   - Add minimum length filter: w.length >= 3 (not 2)

2. In extractThematicVocabulary():
   - Replace inline filter array with MACEDONIAN_STOP_WORDS
   - Increase minimum word length to 3 characters
   - Make the list pattern require 6+ words instead of 5 (more selective)
   - Add filter to skip words that are ALL CAPS (likely headers/labels)

3. In extractSingularPluralPairs():
   - Add stop word filtering to skip pairs where singular is a stop word
   - Ensure minimum 3 character words

4. Create helper function isValidVocabularyWord(word: string): boolean that:
   - Checks word is at least 3 characters
   - Checks word is not in MACEDONIAN_STOP_WORDS
   - Checks word is not all uppercase (headers)
   - Checks word contains only Cyrillic characters
   - Use this helper in all extraction functions
  </action>
  <verify>npx tsx -e "import { extractAllVocabulary } from './scripts/curriculum/vocabulary-patterns'; console.log(extractAllVocabulary('и а во на со јас ти сум е да').length)" should return 0 (all stop words filtered)</verify>
  <done>All extraction functions use stop word list, minimum 3-char words, helper function created</done>
</task>

<task type="auto">
  <name>Task 3: Regenerate A1 vocabulary and verify quality</name>
  <files>data/curriculum/structured/a1-teskoto.json</files>
  <action>
1. Run the A1 structure parser to regenerate with improved extraction:
   npx tsx scripts/curriculum/parse-a1-structure.ts

2. Verify the results meet quality criteria:
   - Total vocabulary should be 300-800 items (not 7,513)
   - Each lesson should have 10+ items (target 20+)
   - No common stop words in output
   - Words should be 3+ characters

3. Sample check the output:
   - Print first 20 vocabulary items from Lesson 1
   - Verify they are meaningful words (nouns, verbs, adjectives)
   - Not function words like "и", "да", "со"

4. If vocabulary count is still too high (>1000), consider adding more stop words
5. If vocabulary count is too low (<200), may need to relax some filters
  </action>
  <verify>node -e "const d=JSON.parse(require('fs').readFileSync('data/curriculum/structured/a1-teskoto.json','utf8')); const total=d.chapters.reduce((s,c)=>s+c.vocabularyItems.length,0); console.log('Total:', total); console.log('Target: 300-800')" should show reasonable total</verify>
  <done>A1 regenerated with 300-800 quality vocabulary items, no stop words in output, each lesson has 10+ items</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npm run type-check` passes
- [ ] MACEDONIAN_STOP_WORDS has 100+ entries
- [ ] A1 vocabulary total between 300-800 (quality over quantity)
- [ ] Sample vocabulary items are meaningful (not "и", "да", "со")
- [ ] Each A1 lesson has 10+ vocabulary items
</verification>

<success_criteria>

- All tasks completed
- All verification checks pass
- Stop word list comprehensive enough to filter function words
- A1 vocabulary reduced from 7,513 to 300-800 quality items
- No common Macedonian function words in vocabulary output
</success_criteria>

<output>
After completion, create `.planning/phases/10-a1-vocabulary-extraction/10-01-SUMMARY.md`:

# Phase 10 Plan 01: A1 Vocabulary Quality Fix Summary

**[Summary of what was accomplished]**

## Accomplishments

## Files Created/Modified

## Decisions Made

## Issues Encountered

## Next Phase Readiness

- Ready for Phase 11: A1 Grammar Content (if vocabulary targets met)
</output>
