---
phase: 04-vocabulary-system
plan: 03
type: execute
---

<objective>
Build practice mode selection UI with filtering by vocab state.

Purpose: Let users choose "Learn new", "Review weak", or "Mixed" practice modes.
Output: Updated practice page with mode selection and filtered decks.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
~/.claude/get-shit-done/templates/summary.md
~/.claude/get-shit-done/references/checkpoints.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/04-vocabulary-system/04-01-SUMMARY.md
@.planning/phases/04-vocabulary-system/04-02-SUMMARY.md

# Practice page to modify:
@app/[locale]/practice/page.tsx

# Hooks from 04-01 and 04-02:
@components/practice/useVocabulary.ts
@components/practice/usePracticeDecks.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add practice mode selector component</name>
  <files>components/practice/PracticeModeSelector.tsx</files>
  <action>
Create mode selector component:

```tsx
type PracticeMode = 'learn-new' | 'review-due' | 'mixed' | 'all';

interface Props {
  counts: VocabCounts;
  selectedMode: PracticeMode;
  onModeSelect: (mode: PracticeMode) => void;
}
```

UI: Card-based selector with:
- "Learn New" - Shows count of new words (mastery 0)
- "Review Due" - Shows count of due words
- "Mixed" - Combines new + due for balanced learning
- "All Words" - Full vocabulary

Each card shows:
- Mode name and description
- Count badge (e.g., "12 new", "5 due")
- Selected state with accent color

Use existing Badge, Card components from shadcn/ui.
Follow existing practice page styling patterns.
  </action>
  <verify>npm run type-check passes</verify>
  <done>PracticeModeSelector component renders mode cards with counts</done>
</task>

<task type="auto">
  <name>Task 2: Integrate mode selector into practice page</name>
  <files>app/[locale]/practice/page.tsx</files>
  <action>
Update practice page to show mode selection:

1. Import useVocabulary and PracticeModeSelector
2. Add state for selected practice mode
3. Show PracticeModeSelector when user has saved vocabulary
4. Filter deck based on selected mode:
   - learn-new: filter to mastery === 0
   - review-due: filter to nextReviewAt <= now
   - mixed: combine new + due, interleaved
   - all: no filter

5. Show "No vocabulary saved yet" message with CTA if counts.total === 0
6. Pass filtered deck to existing practice components

Keep existing practice flows working - mode selector is additive.
Guest users see existing behavior (no mode selector).
  </action>
  <verify>npm run type-check && npm run lint</verify>
  <done>Practice page shows mode selector for logged-in users with vocabulary</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Practice page with vocabulary mode selection</what-built>
  <how-to-verify>
    1. Run: npm run dev
    2. Log in as a user
    3. If no vocabulary: verify helpful empty state message appears
    4. Add vocabulary (via reader or manually)
    5. Visit: http://localhost:3000/en/practice
    6. Verify mode selector shows with counts
    7. Select "Learn New" - verify only new words appear
    8. Select "Review Due" - verify only due words appear
    9. Select "Mixed" - verify combination
    10. Practice a word and verify mastery updates
  </how-to-verify>
  <resume-signal>Type "approved" to continue, or describe issues to fix</resume-signal>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npm run type-check` passes
- [ ] `npm run lint` passes
- [ ] Mode selector component exists
- [ ] Practice page integrates mode selection
- [ ] Human verified mode filtering works
</verification>

<success_criteria>

- Practice mode selector created
- Mode selection filters vocabulary correctly
- Visual verification passed
- Phase 4 complete
</success_criteria>

<output>
After completion, create `.planning/phases/04-vocabulary-system/04-03-SUMMARY.md`
</output>
