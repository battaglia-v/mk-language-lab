---
phase: 01-curriculum-backbone
plan: 02
type: execute
---

<objective>
Extract and structure A1 curriculum from Тешкото textbook.

Purpose: Transform the raw PDF into structured curriculum data that maps to existing Prisma models.
Output: JSON file with A1 lessons, vocabulary, grammar notes ready for database import.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
~/.claude/get-shit-done/templates/summary.md
~/.claude/get-shit-done/references/checkpoints.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-curriculum-backbone/01-RESEARCH.md
@.planning/phases/01-curriculum-backbone/01-01-SUMMARY.md (after 01-01 completes)
@scripts/curriculum/extract-pdf.ts
@scripts/curriculum/types.ts
@prisma/schema.prisma

**Depends on:** Plan 01-01 complete (extraction scripts exist, PDFs downloaded)
**Tech available:** pdfjs-dist, extraction scaffold from 01-01
**Target models:** Module, CurriculumLesson, VocabularyItem, GrammarNote, Exercise
</context>

<tasks>

<task type="auto">
  <name>Task 1: Extract raw text with positions from Тешкото PDF</name>
  <files>scripts/curriculum/extract-a1.ts, data/curriculum/extracted/a1-raw.json</files>
  <action>
1. Create extract-a1.ts that:
   - Loads data/curriculum/raw/a1-teskoto.pdf
   - Uses extractPdfText() from extract-pdf.ts
   - Saves full extraction to data/curriculum/extracted/a1-raw.json
   - Logs extraction stats: page count, total text items, character validation results
2. Create data/curriculum/extracted/ directory
3. Run extraction: `npx tsx scripts/curriculum/extract-a1.ts`
4. Validate output includes Macedonian special characters (Ѓ, Ќ, Љ, Њ, Џ)

Do NOT proceed if Cyrillic characters are garbled (mojibake). Do NOT skip position data (x, y, fontSize).
  </action>
  <verify>cat data/curriculum/extracted/a1-raw.json | head -100 shows Cyrillic text with position data</verify>
  <done>Raw extraction complete, JSON file exists with valid Cyrillic text and positions</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Raw text extraction from Тешкото A1 textbook PDF</what-built>
  <how-to-verify>
    1. Open: data/curriculum/extracted/a1-raw.json
    2. Check: Cyrillic characters display correctly (should see: Здраво, Добар ден, etc.)
    3. Check: Position data present (items have x, y, fontSize fields)
    4. Check: Multiple pages extracted (pageNum values vary)
    5. Identify: Look for chapter/lesson headers (larger fontSize values)
    6. Note: Any patterns for vocabulary sections (word - translation format)
  </how-to-verify>
  <resume-signal>Type "approved" to continue, or describe issues (e.g., "Cyrillic garbled on page 5")</resume-signal>
</task>

<task type="auto">
  <name>Task 3: Parse structure into curriculum JSON</name>
  <files>scripts/curriculum/parse-a1-structure.ts, data/curriculum/structured/a1-teskoto.json</files>
  <action>
1. Create parse-a1-structure.ts that:
   - Loads a1-raw.json
   - Detects chapter boundaries using fontSize thresholds (headers are larger)
   - Identifies vocabulary sections (patterns like "word - translation" or tabular layouts)
   - Extracts grammar notes (sections with explanations)
   - Maps to ExtractedTextbook structure matching Prisma models:
     - journeyId: "ukim-a1"
     - Chapters become Modules
     - Sections become CurriculumLessons
     - Word lists become VocabularyItems
     - Grammar explanations become GrammarNotes
2. Create data/curriculum/structured/ directory
3. Run parsing: `npx tsx scripts/curriculum/parse-a1-structure.ts`
4. Output structured JSON to data/curriculum/structured/a1-teskoto.json

Structure detection will be imperfect - prioritize capturing content over perfect categorization.
Manual review and refinement expected in future iterations.
  </action>
  <verify>cat data/curriculum/structured/a1-teskoto.json | jq '.chapters | length' shows chapter count > 0</verify>
  <done>Structured A1 JSON exists with chapters, lessons, vocabulary items identified</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] data/curriculum/extracted/a1-raw.json exists with valid Cyrillic
- [ ] data/curriculum/structured/a1-teskoto.json exists with chapter structure
- [ ] JSON structure matches expected schema (journeyId, chapters, lessons)
- [ ] Human verified extraction quality at checkpoint
</verification>

<success_criteria>
- All tasks completed
- Checkpoint approved by human
- A1 curriculum captured in structured JSON format
- Ready for A2 extraction (same patterns apply)
</success_criteria>

<output>
After completion, create `.planning/phases/01-curriculum-backbone/01-02-SUMMARY.md`
</output>
