---
phase: 01-curriculum-backbone
plan: 01
type: execute
---

<objective>
Set up PDF parsing infrastructure and download UKIM textbooks.

Purpose: Establish the tooling foundation for extracting curriculum content from official Macedonian language textbooks.
Output: Working extraction script scaffold and downloaded PDF files ready for parsing.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-curriculum-backbone/01-RESEARCH.md

**Tech stack available:** Next.js 16, TypeScript 5, Prisma 6, Node.js
**Established patterns:** Module exports in lib/, scripts in scripts/
**Constraining decisions:**
- Use pdfjs-dist for PDF parsing (from RESEARCH.md)
- Store extracted content as JSON before database import

**Source URLs (from RESEARCH.md):**
- Тешкото: https://archive.ukim.edu.mk/msmjlk/uchebnici/TESKOTO_Simon_Sazdov.pdf
- Лозје: https://archive.ukim.edu.mk/msmjlk/uchebnici/LOZJE_Gordana_Aleksova.pdf
- Златоврв: https://archive.ukim.edu.mk/msmjlk/uchebnici/ZLATOVRV_Aneta_Ducevska.pdf
</context>

<tasks>

<task type="auto">
  <name>Task 1: Install pdfjs-dist and create extraction script scaffold</name>
  <files>package.json, scripts/curriculum/extract-pdf.ts, scripts/curriculum/types.ts</files>
  <action>
1. Install pdfjs-dist: `npm install pdfjs-dist@5.4.530`
2. Create scripts/curriculum/ directory structure
3. Create types.ts with interfaces:
   - ExtractedPage (pageNum, text, items with str/x/y/fontSize)
   - ExtractedTextbook (id, title, level, pages)
4. Create extract-pdf.ts with:
   - Function extractPdfText(pdfPath: string): Promise<ExtractedPage[]>
   - Use pdfjs-dist/legacy/build/pdf.mjs for Node.js compatibility
   - Extract text with position data (transform[4], transform[5] for x/y)
   - Apply String.normalize('NFC') for Cyrillic
   - Include Macedonian character validation (check for Ѓ, Ќ, Љ, Њ, Џ)
5. Add npm script: "extract:pdf": "npx tsx scripts/curriculum/extract-pdf.ts"

Do NOT use pdf-parse (less maintained). Do NOT skip position data extraction (needed for structure detection).
  </action>
  <verify>npm run extract:pdf --help shows usage without errors, TypeScript compiles</verify>
  <done>Script scaffold exists, types defined, pdfjs-dist installed, npm script runnable</done>
</task>

<task type="auto">
  <name>Task 2: Download UKIM textbook PDFs</name>
  <files>scripts/curriculum/download-pdfs.ts, data/curriculum/raw/.gitkeep</files>
  <action>
1. Create data/curriculum/raw/ directory (gitignored for large PDFs)
2. Add to .gitignore: `data/curriculum/raw/*.pdf`
3. Create download-pdfs.ts script that:
   - Downloads all 3 PDFs from UKIM archive using fetch
   - Saves to data/curriculum/raw/ with names: a1-teskoto.pdf, a2-lozje.pdf, b1-zlatovrv.pdf
   - Verifies file sizes are reasonable (>1MB each)
   - Logs download progress and final file sizes
4. Add npm script: "curriculum:download": "npx tsx scripts/curriculum/download-pdfs.ts"
5. Run the download script to fetch all PDFs
6. Verify all 3 files exist and have content

Do NOT commit the PDF files (they're large and copyrighted). Do NOT skip verification of downloads.
  </action>
  <verify>ls -la data/curriculum/raw/ shows 3 PDF files with sizes >1MB each</verify>
  <done>All 3 UKIM PDFs downloaded, gitignore configured, download script reusable</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npm run type-check` passes
- [ ] pdfjs-dist in package.json dependencies
- [ ] scripts/curriculum/extract-pdf.ts exists and compiles
- [ ] scripts/curriculum/download-pdfs.ts exists and compiles
- [ ] data/curriculum/raw/ contains 3 PDF files
- [ ] .gitignore excludes PDF files
</verification>

<success_criteria>
- All tasks completed
- All verification checks pass
- PDF extraction infrastructure ready for A1 extraction in 01-02
- Downloaded PDFs available locally for parsing
</success_criteria>

<output>
After completion, create `.planning/phases/01-curriculum-backbone/01-01-SUMMARY.md`
</output>
