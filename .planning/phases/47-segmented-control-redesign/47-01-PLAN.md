---
phase: 47-segmented-control-redesign
plan: 01
type: execute
---

<objective>
Modernize the Tabs component into a polished iOS-style segmented control with smooth animations across all 4 locations.

Purpose: Improve visual consistency and UX by creating a modern, unified tab/toggle pattern.
Output: Redesigned Tabs component with sliding indicator animation, applied consistently across Reader, Alphabet, TextImporter, and DailyLessons.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
~/.claude/get-shit-done/templates/summary.md
~/.claude/get-shit-done/references/checkpoints.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

# Existing base component:
@components/ui/tabs.tsx

# 4 locations using tabs:
@app/[locale]/reader/page.tsx
@app/[locale]/learn/lessons/alphabet/page.tsx
@components/reader/TextImporter.tsx
@components/learn/DailyLessons.tsx

**Established patterns:**
- Radix UI primitives with Tailwind styling
- shadcn/ui component architecture
- 48px minimum touch targets for mobile
- Consistent data-testid attributes

**Current issues identified:**
- Each location applies different grid/height overrides
- Missing smooth sliding indicator animation
- Inconsistent spacing between consumers
</context>

<tasks>

<task type="auto">
  <name>Task 1: Redesign Tabs component with sliding indicator</name>
  <files>components/ui/tabs.tsx</files>
  <action>
Redesign the Tabs component with a modern iOS-style segmented control pattern:

1. **TabsList updates:**
   - Add relative positioning for indicator placement
   - Improve background styling with subtle gradient/glass effect
   - Ensure consistent padding and rounded corners (rounded-xl)
   - Add min-h-[48px] as default for touch targets

2. **TabsTrigger updates:**
   - Add z-10 to keep text above the sliding indicator
   - Remove individual background styling (indicator will handle this)
   - Keep hover/focus states for accessibility
   - Ensure smooth color transitions (200-300ms)

3. **Add sliding indicator:**
   - Use CSS custom properties + data-attributes for positioning
   - The indicator should slide smoothly between tabs
   - Use Tailwind's transition-all with duration-300
   - Background: bg-background with shadow for depth
   - Position: absolute, inset-y with rounded corners

4. **Approach - CSS-only indicator:**
   - Use `[&:has([data-state=active])]:*` selectors or
   - Add indicator as a pseudo-element on active trigger
   - Alternative: Use layoutId with framer-motion (but prefer CSS if possible)

5. **Styling values:**
   - List: `bg-muted/50 p-1 rounded-xl min-h-[48px]`
   - Active indicator: `bg-background shadow-sm rounded-lg`
   - Trigger text: `text-muted-foreground data-[state=active]:text-foreground`
   - Transitions: `transition-all duration-200 ease-out`

**What to avoid and WHY:**
- Don't use JavaScript for indicator position calculation (causes jank, prefer CSS)
- Don't change the Radix primitives API (would break consumers)
- Don't add framer-motion dependency just for this (overkill for this effect)
  </action>
  <verify>npm run type-check && npm run lint</verify>
  <done>
- Tabs component updated with modern segmented control styling
- No TypeScript or lint errors
- API remains compatible with existing consumers
  </done>
</task>

<task type="auto">
  <name>Task 2: Update consumers for consistency</name>
  <files>
app/[locale]/reader/page.tsx,
app/[locale]/learn/lessons/alphabet/page.tsx,
components/reader/TextImporter.tsx,
components/learn/DailyLessons.tsx
  </files>
  <action>
Review and update all 4 locations that use Tabs to ensure consistency:

1. **Reader page (lines 231-241):**
   - Current: `TabsList className="grid w-full grid-cols-2 mb-6 min-h-[48px]"`
   - Review: Keep grid-cols-2 but remove min-h if now in base
   - Update TabsTrigger: Remove redundant min-h-[48px] if handled by base

2. **Alphabet page (lines 186-199):**
   - Current: `TabsList className="grid h-11 w-full grid-cols-3 gap-1 rounded-2xl bg-muted/70 p-1"`
   - Review: Simplify to `grid grid-cols-3 w-full` if base handles styling
   - The custom rounded-2xl and bg-muted/70 may conflict - standardize

3. **TextImporter (lines 76-85):**
   - Current: `TabsList className="grid w-full grid-cols-2 min-h-[48px]"`
   - Review: Simplify - this is in a dialog so sizing should match base

4. **DailyLessons (lines 483-493):**
   - Current: `TabsList className="grid w-full grid-cols-2 mb-6"`
   - Review: Add consistent spacing pattern

**Standardization goals:**
- Remove redundant min-h-[48px] from TabsTrigger (base handles it)
- Keep grid-cols-N as that varies by use case
- Keep w-full where needed
- Standardize margin-bottom spacing (mb-4 or mb-6)
- Remove custom bg-muted/70, let base component handle

**What to avoid and WHY:**
- Don't change functionality - this is styling only
- Don't remove data-testid attributes (used by E2E tests)
- Don't change tab values or state management
  </action>
  <verify>npm run type-check && npm run dev (manual check all 4 locations)</verify>
  <done>
- All 4 consumers use consistent TabsList/TabsTrigger styling
- No duplicate styling between base and consumers
- Type check passes
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Redesigned segmented control tabs across 4 locations</what-built>
  <how-to-verify>
1. Run: `npm run dev`
2. Visit: http://localhost:3000/en/reader
   - Check Library | Workspace tabs have smooth sliding indicator
   - Tab text should transition smoothly
   - Touch target should feel right on mobile viewport (use DevTools)

3. Visit: http://localhost:3000/en/learn/lessons/alphabet
   - Check Learn | Special | Practice tabs (3-column)
   - Same smooth indicator animation
   - Consistent styling with Reader tabs

4. Visit: http://localhost:3000/en/reader and click "Import" button
   - Check URL | File tabs in dialog
   - Should match the same segmented control style

5. Visit: http://localhost:3000/en/daily-lessons (or find where DailyLessons renders)
   - Check All | Saved tabs
   - Consistent with other locations

6. Test dark mode: Toggle theme and verify all 4 locations look correct
  </how-to-verify>
  <resume-signal>Type "approved" to continue, or describe issues to fix</resume-signal>
</task>

</tasks>

<verification>
Before declaring phase complete:
- [ ] `npm run type-check` passes
- [ ] `npm run lint` passes with no new warnings
- [ ] All 4 tab locations visually consistent
- [ ] Sliding indicator animates smoothly
- [ ] Dark mode works correctly
- [ ] No E2E tests broken (run `npm run test:e2e` if time permits)
</verification>

<success_criteria>

- Tabs component redesigned with modern segmented control pattern
- Smooth sliding indicator animation (CSS-based)
- All 4 consumers updated for consistency
- No TypeScript or lint errors
- Visual verification approved
</success_criteria>

<output>
After completion, create `.planning/phases/47-segmented-control-redesign/47-01-SUMMARY.md`
</output>
