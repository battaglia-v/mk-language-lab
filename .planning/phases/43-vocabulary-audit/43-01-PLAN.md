---
phase: 43-vocabulary-audit
plan: 01
type: execute
---

<objective>
Curate vocabulary to be theme-relevant and appropriately scoped per lesson.

Purpose: Current vocabulary extraction produced 25,560 items with many instructional words, proper nouns, and duplicates. Lessons need focused vocabulary sets (30-50 core words) that align with lesson themes.
Output: Updated vocabulary JSON files with curated content, reseeded database, and verification that lessons display meaningful vocabulary.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
./summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/42-lesson-flow-simplification/42-01-SUMMARY.md

# Vocabulary Data Sources
@data/curriculum/structured/a1-teskoto.json
@data/curriculum/structured/a2-lozje.json
@data/curriculum/structured/b1-zlatovrv.json

# Existing Correction Scripts
@scripts/curriculum/vocabulary-corrections.ts
@scripts/curriculum/vocabulary-corrections-a2.ts
@scripts/curriculum/vocabulary-corrections-b1.ts

# Seeding Scripts
@prisma/seed-curriculum-ukim.ts

# UI Component (for understanding filtering requirements)
@components/learn/VocabularySection.tsx

**Current State:**
- A1: 5,186 vocabulary items (avg 216/lesson) - need ~30-50 core words per lesson
- A2: 8,372 vocabulary items (avg 1,047/lesson) - massively over-extracted
- B1: 12,002 vocabulary items (avg 1,500/lesson) - massively over-extracted

**Key Issues to Fix:**
1. Instructional words included (Вежба, Состави, Прочитај, etc.)
2. Proper nouns not relevant to lesson themes
3. Words repeated across many lessons (should appear in first introduction only)
4. Theme misalignment (words from textbook exercises, not vocabulary lists)
5. Current UI filters to MAX 20 at runtime, hiding the bloat but not fixing source

**Target State:**
- Each lesson has 30-50 focused vocabulary items
- Words are theme-relevant (Lesson 8 "Food & Drink" has food words)
- Instructional/meta words removed from data
- Proper nouns appropriately flagged or removed
- Database reseeded with curated vocabulary
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create vocabulary audit report script</name>
  <files>scripts/curriculum/vocabulary-audit-report.ts</files>
  <action>
Create a script that analyzes all vocabulary files and produces a detailed audit report showing:

1. Per-lesson breakdown: word count, instructional word count, proper noun count
2. Duplication analysis: words appearing in multiple lessons (should only appear in first lesson)
3. Theme alignment check: sample words vs lesson title theme
4. Part-of-speech distribution per lesson
5. Identify candidates for removal (instructional words, duplicates, irrelevant proper nouns)

The script should output both console summary and a JSON report to `data/curriculum/vocabulary-audit.json`.

Use the EXCLUDED_WORDS and COUNTRY_NAMES sets from VocabularySection.tsx as baseline, plus add:
- Instructional verbs: прочитај, напиши, одговори, слушај, говори, погледни, пополни, повтори, состави
- Meta words: вежба, лекција, тема, пример, примери, текст, слика, слики
- Exercise fragments that aren't real vocabulary

Run with: `npx tsx scripts/curriculum/vocabulary-audit-report.ts`
  </action>
  <verify>Script runs without errors and produces vocabulary-audit.json with per-lesson statistics</verify>
  <done>Audit report generated showing vocabulary issues per lesson, duplicate words identified, instructional words counted</done>
</task>

<task type="auto">
  <name>Task 2: Implement enhanced vocabulary curation</name>
  <files>scripts/curriculum/curate-vocabulary.ts</files>
  <action>
Create a comprehensive curation script that:

1. **Remove instructional/meta words** - Expand the WORDS_TO_REMOVE set with all instructional verbs and meta words identified in Task 1
2. **Deduplicate across lessons** - Track which words have been introduced; only include a word in its FIRST lesson appearance
3. **Remove irrelevant proper nouns** - Keep country/city names in their relevant lessons (e.g., geography lessons), remove random names from exercises
4. **Cap per-lesson vocabulary** - Target 30-50 words per lesson, prioritizing:
   - Words with clear theme relevance (use lesson title to infer theme)
   - Core vocabulary (common nouns, verbs, adjectives) over obscure terms
   - Words with quality translations
5. **Flag theme-relevant vocabulary** - Add a `themeRelevant: boolean` field to help UI prioritize

The script should:
- Read from structured JSON files
- Apply curation rules
- Write to NEW files: `a1-teskoto-curated.json`, etc.
- Produce a diff summary showing removals

This allows comparison before replacing originals.

Run with: `npx tsx scripts/curriculum/curate-vocabulary.ts`
  </action>
  <verify>`ls data/curriculum/structured/*-curated.json` shows curated files exist, `jq '[.chapters[].vocabularyItems | length] | add' data/curriculum/structured/a1-teskoto-curated.json` shows significantly reduced count</verify>
  <done>Curated vocabulary files created with 30-50 words per lesson average, instructional words removed, duplicates eliminated</done>
</task>

<task type="auto">
  <name>Task 3: Apply curation and reseed database</name>
  <files>data/curriculum/structured/a1-teskoto.json, data/curriculum/structured/a2-lozje.json, data/curriculum/structured/b1-zlatovrv.json</files>
  <action>
1. Review the curated files from Task 2
2. If curation looks good, replace originals:
   ```bash
   cp data/curriculum/structured/a1-teskoto-curated.json data/curriculum/structured/a1-teskoto.json
   cp data/curriculum/structured/a2-lozje-curated.json data/curriculum/structured/a2-lozje.json
   cp data/curriculum/structured/b1-zlatovrv-curated.json data/curriculum/structured/b1-zlatovrv.json
   ```
3. Run vocabulary corrections script to apply any manual fixes:
   ```bash
   npx tsx scripts/curriculum/vocabulary-corrections.ts
   ```
4. Reseed the database:
   ```bash
   npx prisma db seed
   ```
5. Update validation report:
   ```bash
   npx tsx scripts/curriculum/validate-content.ts
   ```

The goal is ~1,200-2,000 total vocabulary items for A1 (down from 5,186), with similar proportional reductions for A2/B1.
  </action>
  <verify>
- `npx prisma db seed` completes successfully
- `npx tsx scripts/curriculum/validate-content.ts` passes all checks
- Spot check: lesson vocabulary in dev server shows theme-relevant words without instructional clutter
  </verify>
  <done>
- Original JSON files replaced with curated versions
- Database reseeded with focused vocabulary
- Validation passes
- Dev server shows improved vocabulary per lesson
  </done>
</task>

</tasks>

<verification>
Before declaring phase complete:
- [ ] `npm run type-check` passes
- [ ] `npm run lint` passes
- [ ] Audit report exists at `data/curriculum/vocabulary-audit.json`
- [ ] Total vocabulary count reduced significantly (target: A1 ~1,500, A2 ~2,500, B1 ~3,500)
- [ ] Lesson 8 "Food & Drink" vocabulary is primarily food-related words
- [ ] No instructional words (вежба, состави, прочитај) appear in vocabulary sections
- [ ] Database seeding completes without errors
</verification>

<success_criteria>

- All tasks completed
- Vocabulary reduced to 30-50 focused words per lesson
- Instructional/meta words removed
- Cross-lesson duplication eliminated (words appear in first introduction only)
- Database reseeded with curated vocabulary
- Validation script passes
</success_criteria>

<output>
After completion, create `.planning/phases/43-vocabulary-audit/43-01-SUMMARY.md`:

# Phase 43 Plan 01: Vocabulary Audit & Curation Summary

**[One-liner describing vocab curation outcome]**

## Accomplishments

- [Audit findings]
- [Curation results - before/after counts]
- [Database reseed confirmation]

## Files Created/Modified

- `scripts/curriculum/vocabulary-audit-report.ts` - Audit script
- `scripts/curriculum/curate-vocabulary.ts` - Curation script
- `data/curriculum/structured/*.json` - Updated vocabulary
- `data/curriculum/vocabulary-audit.json` - Audit report

## Decisions Made

[Any decisions about word inclusion/exclusion criteria]

## Issues Encountered

[Problems and resolutions, or "None"]

## Next Phase Readiness

Ready for Phase 44: Grammar Audit & Improvements
</output>
