---
phase: 27-bug-fixes
plan: 02
type: execute
---

<objective>
Add expandable examples to grammar sections and verify conditional tap hints.

Purpose: Improve grammar learning UX by making all examples accessible, and ensure tap hints only appear when needed.
Output: Grammar examples expandable beyond first 4, tap hints conditionally shown.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
./summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

**Prior work:**
- VocabularySection already has expandable example sentences pattern (lines 215-225)
- GrammarSection shows "+X more examples" as static text, not clickable

**Affected files:**
- components/learn/GrammarSection.tsx (expandable examples)
- components/learn/VocabularySection.tsx (verify tap hints)
- components/learn/EnhancedVocabularyCard.tsx (verify tap hints)
- components/learn/GrammarExerciseCard.tsx (verify tap hints)

**Pattern to follow:**
VocabularySection's expandable pattern uses useState for showAllExamples toggle.
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add expandable examples to GrammarSection</name>
  <files>components/learn/GrammarSection.tsx</files>
  <action>
Implement expandable examples pattern in GrammarSection (modeled after VocabularySection):

1. Add state: `const [showAllExamples, setShowAllExamples] = useState(false)`

2. Replace static "+X more examples" text (lines 123-126) with interactive button:
```tsx
{examples.length > 4 && !showAllExamples && (
  <li>
    <button
      onClick={() => setShowAllExamples(true)}
      className="text-sm text-primary hover:text-primary/80 pl-9 flex items-center gap-1"
    >
      <ChevronDown className="h-3 w-3" />
      Show {examples.length - 4} more examples
    </button>
  </li>
)}
```

3. Update examples.slice() to respect showAllExamples:
```tsx
{(showAllExamples ? examples : examples.slice(0, 4)).map((example, index) => (
  // existing mapping
))}
```

4. Add collapse button when expanded:
```tsx
{showAllExamples && examples.length > 4 && (
  <li>
    <button
      onClick={() => setShowAllExamples(false)}
      className="text-sm text-muted-foreground hover:text-foreground pl-9 flex items-center gap-1"
    >
      <ChevronUp className="h-3 w-3" />
      Show fewer
    </button>
  </li>
)}
```

5. Import ChevronDown, ChevronUp from lucide-react if not already present.

Why this matters: Users learning grammar often want to see all examples to understand the pattern, but showing all by default clutters the UI.
  </action>
  <verify>npm run type-check passes; verify in browser that clicking "Show X more examples" expands the list</verify>
  <done>Grammar examples are expandable, "+X more" is clickable, collapse button available when expanded</done>
</task>

<task type="auto">
  <name>Task 2: Verify and fix conditional tap hints</name>
  <files>components/learn/VocabularySection.tsx, components/learn/EnhancedVocabularyCard.tsx, components/learn/GrammarExerciseCard.tsx</files>
  <action>
Verify that tap hints only show when appropriate:

1. **VocabularySection.tsx (lines 229-232)**
   - Current: Shows "Tap to reveal" only when `!revealed`
   - Expected: Correct behavior - verify no changes needed

2. **EnhancedVocabularyCard.tsx (lines 185-189)**
   - Current: Shows "Tap for example" only when `hasExample && !showExample`
   - Expected: Correct behavior - verify no changes needed

3. **GrammarExerciseCard.tsx (line 418)**
   - Current: Shows `t.tapToSelect` when `userAnswer.length === 0`
   - Expected: Correct for sentence builder exercises
   - BUT: Verify this doesn't show for fill-in-the-blank or other exercise types

4. Check if there are other tap hints in the codebase that should be conditional:
   - Search for "tap" in components/learn/ and components/practice/
   - Verify each shows only when action is available

If any tap hints show unconditionally, add appropriate conditional rendering.

Pattern: Tap hints should follow the pattern: `{!actionTaken && <TapHint />}`
  </action>
  <verify>npm run type-check passes; manually test vocabulary cards and grammar exercises to verify hints appear/disappear correctly</verify>
  <done>All tap hints are conditionally rendered, showing only when the action is available</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npm run type-check` succeeds without errors
- [ ] `npm run lint` passes
- [ ] Grammar sections with >4 examples show expandable button
- [ ] Tap hints appear only when relevant action is available
</verification>

<success_criteria>

- GrammarSection examples are expandable (click to show all, click to collapse)
- Tap hints verified to be conditional across all components
- No TypeScript errors introduced
- UX is consistent between VocabularySection and GrammarSection
</success_criteria>

<output>
After completion, create `.planning/phases/27-bug-fixes/27-02-SUMMARY.md`
</output>
