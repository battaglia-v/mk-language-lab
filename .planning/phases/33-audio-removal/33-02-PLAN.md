---
phase: 33-audio-removal
plan: 02
type: execute
---

<objective>
Clean up audio references in remaining components, remove database schema, and delete i18n keys.

Purpose: Complete the audio removal by fixing all broken imports, removing unused schema models, and cleaning translation files.
Output: TypeScript compiles, all tests pass, database schema clean, no audio references remain.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
./33-02-summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/33-audio-removal/33-01-SUMMARY.md (read after Plan 01 completes)

**Components needing import cleanup (~25 files):**
- components/reader/WordDetailPopup.tsx
- components/reader/WordBottomSheet.tsx
- components/reader/ReaderWorkspace.tsx
- components/reader/GlossaryDrawer.tsx
- components/reader/MarkCompleteButton.tsx
- components/learn/LessonPageContentV2.tsx
- components/learn/DialogueViewer.tsx
- components/learn/quick-practice/Prompt.tsx
- components/learn/QuickPracticeWidget.tsx
- components/learn/EnhancedVocabularyCard.tsx
- components/learn/WordOfTheDay.tsx
- components/learn/VocabularySection.tsx
- components/tools/ToolsPageClient.tsx
- components/gamification/ReviewPrompt.tsx
- components/shell/LessonShell.tsx
- components/dashboard/SmartRecommendations.tsx
- components/dashboard/RecommendationCard.tsx
- components/lesson/steps/MultipleChoice.tsx
- components/lesson/steps/FillBlank.tsx
- components/practice/ClozeSession.tsx
- app/admin/word-of-the-day/page.tsx
- app/admin/layout.tsx (sidebar link to practice-audio)
- app/[locale]/resources/page.tsx

**Database schema to remove (prisma/schema.prisma):**
- PracticeAudio model
- ListeningExercise model
- ListeningQuestion model
- PracticeAudioStatus enum
- PracticeAudioSource enum
- listeningExercises relation from CurriculumLesson

**i18n keys to remove (~37 audio-related keys in messages/en.json and messages/mk.json):**
- All keys containing: pronunciation, listening, speaking, audio, record, listen (except non-audio uses)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Fix broken imports in components</name>
  <files>
    All components listed in context that import deleted audio files
  </files>
  <action>
Run TypeScript to identify broken imports:
```bash
npm run type-check 2>&1 | grep -E "Cannot find module|has no exported member" | head -50
```

For each broken import:
1. Remove import statements for deleted audio hooks/components
2. Remove any state/effects that used those imports
3. Remove UI elements that depended on audio (listen buttons, audio players)
4. Keep non-audio functionality intact

Common patterns to remove:
- `import { useAudioPlayer } from '@/hooks/use-audio-player'` → delete
- `import { AudioStatus } from '@/components/ui/audio-status'` → delete
- `const { play, pause } = useAudioPlayer()` → delete hook usage
- Audio button JSX → delete or replace with placeholder/tooltip

Focus on surgical removal - don't refactor surrounding code.
  </action>
  <verify>`npm run type-check` passes without audio-related errors</verify>
  <done>All audio imports removed, TypeScript compiles cleanly</done>
</task>

<task type="auto">
  <name>Task 2: Remove audio models from Prisma schema</name>
  <files>prisma/schema.prisma</files>
  <action>
Remove audio-related models and relations from schema:

1. Delete PracticeAudio model (lines ~566-593)
2. Delete PracticeAudioStatus enum (lines ~595-600)
3. Delete PracticeAudioSource enum (lines ~602-605)
4. Delete ListeningExercise model (lines ~468-483)
5. Delete ListeningQuestion model (lines ~485-499)
6. Remove `listeningExercises ListeningExercise[]` from CurriculumLesson model (line ~255)

After editing:
```bash
npx prisma validate
npx prisma generate
```

Note: Do NOT run migrations - these models have no production data. The schema change is safe.
  </action>
  <verify>`npx prisma validate` passes, `npx prisma generate` succeeds</verify>
  <done>Schema cleaned of audio models, Prisma client regenerated</done>
</task>

<task type="auto">
  <name>Task 3: Remove audio i18n keys and update tests</name>
  <files>
    messages/en.json
    messages/mk.json
    e2e/*.spec.ts (those referencing removed routes)
  </files>
  <action>
Remove audio-related i18n keys from both translation files:

1. Search for and remove keys:
   - "pronunciation" sections (all nested keys)
   - "listening" sections
   - "speaking" (practice mode)
   - Individual keys: listenButton, playingAudio, slowButton, listenTTS, listenToWord, listenToExample, etc.

2. Update E2E tests that reference removed pages:
   - Remove/skip tests that navigate to /practice/pronunciation
   - Update any assertions about audio UI elements
   - Check: mobile-audit-comprehensive.spec.ts, resources.spec.ts, mobile-journey.spec.ts

3. Update admin sidebar if it links to practice-audio page

Run tests to verify:
```bash
npm run test
npm run test:e2e -- --grep -v pronunciation
```
  </action>
  <verify>i18n validation passes (if exists), E2E tests pass, no runtime audio key errors</verify>
  <done>Translation files cleaned, tests updated, no audio references in UI</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npm run type-check` passes
- [ ] `npm run lint` passes
- [ ] `npm run build` succeeds
- [ ] `npx prisma validate` succeeds
- [ ] `npm run test` passes
- [ ] No "audio", "pronunciation", "listening" strings in active code (grep check)
</verification>

<success_criteria>

- All broken imports fixed
- TypeScript compiles without errors
- Database schema has no audio models
- i18n files cleaned of audio keys
- E2E tests updated to skip removed routes
- Build succeeds
- Phase 33 complete - audio fully removed
</success_criteria>

<output>
After completion, create `.planning/phases/33-audio-removal/33-02-SUMMARY.md`:

# Phase 33 Plan 02: Component Cleanup & Schema Removal Summary

**[One-liner: cleanup scope and result]**

## Accomplishments

- Fixed imports in X components
- Removed 5 database models/enums from schema
- Cleaned ~37 i18n keys from both translation files
- Updated X E2E tests

## Files Modified

- prisma/schema.prisma - Removed audio models
- messages/en.json - Removed audio keys
- messages/mk.json - Removed audio keys
- [List of components modified]

## Decisions Made

[Any decisions about what to keep vs remove]

## Issues Encountered

[Problems and resolutions]

## Next Phase Readiness

Phase 33 complete. Ready for Phase 34: Remaining Polish.
</output>
